<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<div th:replace="~{include::head}"></div>
<style type="text/css">
    .selected {
        color: yellow;
        background-color: green;
    }
</style>
<body>
<div th:replace="~{include::navbar-wrapper}"></div>
<div class="container theme-showcase" role="main">
    <div th:replace="~{include::container}"></div>
    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <form id="projectForm" th:action="@{/project/save/project/basic/info}" method="post" enctype="multipart/form-data" class="form-horizontal">
                    <p style="font-size: 15px;color: #ff0000;text-align: center" th:text="${message}"></p>
                    <div class="panel panel-default">
                        <div class="panel-heading" style="text-align: center;">
                            <div class="container-fluid">
                                <div class="row clearfix">
                                    <div class="col-md-3 column">
                                        <div class="progress" style="height: 50px; border-radius: 0; position: absolute; width: 75%; right: 49px;">
                                            <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 100%; height: 50px;">
                                                <div style="font-size: 16px; margin-top: 15px;">1.项目及发起人信息</div>
                                            </div>
                                        </div>
                                        <div style="right: 0; border: 10px solid #ddd; border-left-color: #88b7d5; border-width: 25px; position: absolute; border-left-color: rgba(92, 184, 92, 1); border-top-color: rgba(92, 184, 92, 0); border-bottom-color: rgba(92, 184, 92, 0); border-right-color: rgba(92, 184, 92, 0);"></div>
                                    </div>
                                    <div class="col-md-3 column">
                                        <div class="progress" style="height: 50px; border-radius: 0; position: absolute; width: 75%; right: 49px;">
                                            <div class="progress-bar progress-bar-default" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 100%; height: 50px;">
                                                <div style="font-size: 16px; margin-top: 15px;">2.回报设置</div>
                                            </div>
                                        </div>
                                        <div style="right: 0; border: 10px solid #ddd; border-left-color: #88b7d5; border-width: 25px; position: absolute; border-left-color: rgba(221, 221, 221, 1); border-top-color: rgba(221, 221, 221, 0); border-bottom-color: rgba(221, 221, 221, 0); border-right-color: rgba(221, 221, 221, 0);"></div>
                                    </div>
                                    <div class="col-md-3 column">
                                        <div class="progress" style="height: 50px; border-radius: 0; position: absolute; width: 75%; right: 49px;">
                                            <div class="progress-bar progress-bar-default" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 100%; height: 50px;">
                                                <div style="font-size: 16px; margin-top: 15px;">3.确认信息</div>
                                            </div>
                                        </div>
                                        <div style="right: 0; border: 10px solid #ddd; border-left-color: #88b7d5; border-width: 25px; position: absolute; border-left-color: rgba(221, 221, 221, 1); border-top-color: rgba(221, 221, 221, 0); border-bottom-color: rgba(221, 221, 221, 0); border-right-color: rgba(221, 221, 221, 0);"></div>
                                    </div>
                                    <div class="col-md-3 column">
                                        <div class="progress" style="height: 50px; border-radius: 0;">
                                            <div class="progress-bar progress-bar-default" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 100%; height: 50px;">
                                                <div style="font-size: 16px; margin-top: 15px;">4.完成</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel-body">
                            <div class="container-fluid">
                                <div class="row clearfix">
                                    <div class="col-md-12 column">
                                        <blockquote style="border-left: 5px solid #f60; color: #f60; padding: 0 0 0 20px;">
                                            <b> 项目及发起人信息 </b>
                                        </blockquote>
                                    </div>
                                    <div class="col-md-12 column">
                                        <div class="page-header" style="border-bottom-style: dashed;">
                                            <h3>项目信息</h3>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">分类信息</label>
                                            <div class="col-sm-10">
                                                <label class="radio-inline">
                                                    <input type="checkbox" name="typeIdList" value="1"> 科技
                                                </label>
                                                <label class="radio-inline">
                                                    <input type="checkbox" name="typeIdList" value="2" checked="checked"> 设计
                                                </label>
                                                <label class="radio-inline">
                                                    <input type="checkbox" name="typeIdList" value="3"> 公益
                                                </label>
                                                <label class="radio-inline">
                                                    <input type="checkbox" name="typeIdList" value="4" checked="checked"> 农业
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">标签</label>
                                            <div class="col-sm-10">
                                                <ul style="list-style: none; padding-left: 0;">
                                                    <li style="margin: 10px 0">
                                                        [手机]
                                                        <span class="tagLable label-txt" id="4">大屏</span>
                                                        <span class="tagLable label-txt" id="5">美颜</span>
                                                        <span class="tagLable label-txt" id="6">续航</span>
                                                    </li>
                                                    <li style="margin: 10px 0">
                                                        [数码]
                                                        <span class="tagLable label-txt" id="7">高解析度</span>
                                                        <span class="tagLable label-txt" id="8">高清</span>
                                                    </li>
                                                    <li style="margin: 10px 0">
                                                        [电脑]
                                                        <span class="tagLable label-txt" id="9">大内存</span>
                                                        <span class="tagLable label-txt" id="10">固态</span>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">项目名称</label>
                                            <div class="col-sm-10">
                                                <input type="text" name="projectName" value="brotherMao" class="form-control">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">一句话简介</label>
                                            <div class="col-sm-10">
                                                <textarea name="projectDescription" class="form-control" rows="5">就是帅！</textarea>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">筹资金额（元）</label>
                                            <div class="col-sm-10">
                                                <input type="text" name="money" value="100000" class="form-control" style="width: 100px;">
                                                <label class="control-label">筹资金额不能低于100元,不能高于1000000000元</label>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">筹资天数（天）</label>
                                            <div class="col-sm-10">
                                                <input type="text" name="day" value="30" class="form-control" style="width: 100px;">
                                                <label class="control-label">一般10-90天，建议30天</label>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">项目头图</label>
                                            <div class="col-sm-10">
                                                <input type="file" name="headerPicture" style="display: none;" />
                                                <button id="uploadHeadBtn" type="button" class="btn btn-primary btn-lg active">上传图片</button>
                                                <label class="control-label">图片上无文字,支持jpg、jpeg、png、gif格式，大小不超过2M，建议尺寸：740*457px</label>
                                                <br />
                                                <img style="display: none;" />
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">项目详情</label>
                                            <div class="col-sm-10">
                                                <input type="file" multiple="multiple" name="detailPictureList" style="display: none;" />
                                                <button id="uploadDetailBtn" type="button" class="btn btn-primary btn-lg active">上传图片</button>
                                                <label class="control-label">支持jpg、jpeg、png、gif格式，大小不超过2M，建议尺寸：宽740px</label>
                                                <div id="showDetailPicture"></div>
                                            </div>
                                        </div>
                                        <!-- </form> -->
                                    </div>
                                    <div class="col-md-12 column">
                                        <div class="page-header" style="border-bottom-style: dashed;">
                                            <h3>发起人信息</h3>
                                        </div>
                                        <!-- <form class="form-horizontal"> -->
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">自我介绍</label>
                                            <div class="col-sm-10">
                                                <input type="text" name="memberLaunchInfoVO.descriptionSimple" value="i am mao" class="form-control" placeholder="一句话自我介绍，不超过40字">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">详细自我介绍</label>
                                            <div class="col-sm-10">
                                                <textarea name="memberLaunchInfoVO.descriptionDetail" class="form-control" rows="5" placeholder="向支持者详细介绍你自己或你的团队及项目背景，让支持者在最短时间内了解你，不超过160字">我是猫哥</textarea>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">联系电话</label>
                                            <div class="col-sm-10">
                                                <input type="text" name="memberLaunchInfoVO.phoneNum" value="123456" class="form-control" placeholder="此信息不会显示在项目页面">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">客服电话</label>
                                            <div class="col-sm-10">
                                                <input type="text" name="memberLaunchInfoVO.serviceNum" value="654321" class="form-control" placeholder="此信息显示在项目页面">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel-footer" style="text-align: center;">
                            <button id="submitBtn" type="button" class="btn  btn-warning btn-lg">下一步</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div th:replace="~{include::footer}"></div>
</div>
<!-- /container -->
<script type="text/javascript">
    // 声明全局变量用于存储选中的标签的id
    var tagIdList = new Array();

    $(".tagLable").click(function() {

        // 标签文本显示框如果有selected就去掉，如果没有就加上
        $(this).toggleClass("selected");

        // 获取当前文本显示框的id（也就是标签的id）
        var tagId = this.id;

        // 判定tagId是否在数组中，如果在则删除，如果不在则添加
        checkExitsts(tagIdList, tagId);

        console.log(tagIdList);

    });

    function checkExitsts(arr, id) {
        for (var i = 0; i < arr.length; i++) {
            var value = arr[i];
            if (value == id) {

                // 从数组中删除元素，i是元素索引，1是删除数量
                arr.splice(i, 1);

                return;
            }
        }

        // 将当前标签的id加入数组
        arr.push(id);
    }

    $("#uploadHeadBtn").click(function() {

        // 调用click()函数，相当于被点击了一下
        $("[name=headerPicture]").click();
    });

    $("[name=headerPicture]").change(function(event) {

        // 获取用户选中的文件
        var files = event.target.files;

        // 使用下标0，选择唯一的一个文件
        var file = files[0];

        // 获取URL对象
        var url = window.url || window.webkitURL;

        // 调用url对象的createObjectURL()方法获取当前选中的文件在系统中的路径
        var path = url.createObjectURL(file);

        // 使用path修改img标签的src属性
        $(this).next().next().next().next().attr("src", path).show();

    });

    $("#uploadDetailBtn").click(function() {

        $("[name=detailPictureList]").click();

    });

    $("[name=detailPictureList]").change(function(event) {

        $("#showDetailPicture").empty();

        var files = event.target.files;

        var url = window.url || window.webkitURL;

        for (var i = 0; i < files.length; i++) {
            var file = files[i];

            var path = url.createObjectURL(file);

            var imgHtml = "<img src='"+path+"' /><br/>";

            $("#showDetailPicture").append(imgHtml);
        }

    });

    // 点击下一步按钮提交表单
    $("#submitBtn").click(function(){

        // 将表单中标签id的值组成的数组转换成表单内的隐藏域
        for(var i = 0; i < tagIdList.length; i++) {
            var tagId = tagIdList[i];

            var hiddenInputHTML = "<input type='hidden' name='tagIdList' value='"+tagId+"' />";

            $("#projectForm").append(hiddenInputHTML);
        }

        // 提交表单
        $("#projectForm").submit();
    });
</script>
</body>
</html>